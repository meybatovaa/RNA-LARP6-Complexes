# Molecular Dynamics Simulations of Collagen Stem-Loop RNAs

## Overview
This folder contains scripts and input files for molecular dynamics (MD) simulations performed on wild-type (WT) and alternative collagen stem-loop RNA constructs. 
The simulations were carried out using AMBER on the HPC system, with a workflow encompassing system preparation, solvation, minimization, equilibration, and production runs.

---

## Folder Structure

### `inputs/`
Contains all initial files for MD simulations:  

- **AMBER input files (`.in`)** – Minimization, equilibration, and production:
  - `initmin.in` – Initial constrained minimization  
  - `fullmin.in` – Full minimization without constraints  
  - `solveq1.in` … `solveq5.in` – Solvation and equilibration steps  
  - `npt_restr.in` – NPT relaxation with restraints  
  - `nvt.in` – Production NVT MD  
- **RNA sequences and preparation**:
  - `sequences` – RNA sequences for WT and variants    

### `scripts/`
Contains scripts for simulation and analysis:

- `MD_run.sh` – Runs minimization, equilibration, and production MD on HPC  
- `preparation.sh` – Prepares systems in tleap (solvation, ion addition, `.prmtop` and `.inpcrd`)  
- `rmsf_rna` – Computes root-mean-square fluctuation per residue from RNA trajectories using `cpptraj`  
- `rmsf.py` – Visualizes RMSF data generated by `rmsf_rna` in Python, comparing WT and variant constructs 

---

## Working directory
Work from /scratch/prj/roeder_lido_rna/KR_MD_runs ; contains three subdirectories, one for each RNA construct:

- `alpha1I/` – WT stem-loop RNA  
- `alpha1III/` – Alternative collagen stem-loop RNA 
- `alpha2I/` – Alternative collagen stem-loop RNA 

Each subdirectory includes:  
- The MD run script (`.sh`) for submission to the HPC  
- Input files (`.in`) for minimization, equilibration, and production runs  
- Coordinate and topology files (`.prmtop`, `.inpcrd`)  
- RMSF analysis scripts

---

## Workflow

1. **RNA Sequence and Structure Preparation**  
- RNA sequences are provided in `rna_sequences.txt`.  
- 2D secondary structures predicted using [RNAfold](http://rna.tbi.univie.ac.at/cgi-bin/RNAWebSuite/RNAfold.cgi).
- 3D structures generated using [RNAComposer](https://rnacomposer.cs.put.poznan.pl/) and saved as `.pdb`.  

2. **System Setup with tleap**  
- Load `.pdb` structures and solvate using OPC water model.  
- Add counterions (Cl⁻, K⁺) to neutralize the system 
- Generate AMBER topology (`coords.prmtop`) and coordinate (`coords.inpcrd`) files.  

3. **Molecular Dynamics Simulations**  
- Initial minimization (constrained and unconstrained)  
- Solvation equilibration (multi-step heating and relaxation)  
- NPT relaxation with and without restraints  
- Production MD in NVT ensemble (multiple repeats recommended)  

4. **Post-Processing and Analysis**  
- RMSF calculations per residue to monitor structural stability and flexibility  
- Comparison of WT vs variant constructs  

---

## Requirements

- **Software**
  - AMBER22 or higher (`pmemd.cuda`, `tleap`,`cpptraj` )  
  - Python 3.x  
  - Python packages: `numpy`, `matplotlib`, `seaborn`  

- **RNA Structure Preparation**
  - [RNAfold](http://rna.tbi.univie.ac.at/cgi-bin/RNAWebSuite/RNAfold.cgi)  
  - [RNAComposer](https://rnacomposer.cs.put.poznan.pl/)  

- **Hardware**
  - GPU-enabled HPC node for production MD  

---

## Notes

- Input `.in` files may require adjustment of box size (`OPCBOX`) or number of counterions depending on system size.  
- RMSF scripts assume `.dat` files generated using `cpptraj` from AMBER trajectories.  

---

## References

- Cai, L. et al. *Binding of LARP6 to the Conserved 5′ Stem–Loop Regulates Translation of mRNAs Encoding Type I Collagen.* J. Mol. Biol. 395, 309–326 (2010).  
- AMBER Tutorials: [AmberTools MD Setup](https://ambermd.org/tutorials/)
- RNA Secondary Structure Prediction: [RNAfold](http://rna.tbi.univie.ac.at/cgi-bin/RNAWebSuite/RNAfold.cgi)  
- RNA 3D Structure Modeling: [RNAComposer](https://rnacomposer.cs.put.poznan.pl/)  

---
